\input cwebmac
\datethis

\N{1}{1}Data for dancing. This program creates data suitable for the {\mc
DANCE}
routine, solving the famous ``$n$ queens problem.'' The value of~$n$
is a command-line parameter.

\Y\B\8\#\&{include} \.{<stdio.h>}\6
\X3:Global variables\X\6
\X5:Subroutines\X;\7
${}\\{main}(\\{argc},\39\\{argv}){}$\1\1\6
\&{int} \\{argc};\6
\&{char} ${}{*}\\{argv}[\,];\2\2{}$\6
${}\{{}$\1\6
\&{register} \&{int} \|j${},{}$ \|k${},{}$ \|n${},{}$ \\{nn}${},{}$ \|t;\7
\X2:Read the command line\X;\6
\X4:Output the column names\X;\6
\X6:Output the possible queen moves\X;\6
\4${}\}{}$\2\par
\fi

\M{2}\B\X2:Read the command line\X${}\E{}$\6
\&{if} ${}(\\{argc}\I\T{2}\V\\{sscanf}(\\{argv}[\T{1}],\39\.{"\%d"},\39{\AND}%
\\{param})\I\T{1}){}$\5
${}\{{}$\1\6
${}\\{fprintf}(\\{stderr},\39\.{"Usage:\ \%s\ n\\n"},\39\\{argv}[\T{0}]);{}$\6
${}\\{exit}({-}\T{1});{}$\6
\4${}\}{}$\2\6
${}\|n\K\\{param};{}$\6
${}\\{nn}\K\|n+\|n-\T{2}{}$;\par
\U1.\fi

\M{3}\B\X3:Global variables\X${}\E{}$\6
\&{int} \\{param};\par
\U1.\fi

\M{4}We proces the cells of the board in ``organ pipe order,'' on the
assumption
that---all other things being equal---a move near the center yields more
constraints on the subsequent search.

\Y\B\4\X4:Output the column names\X${}\E{}$\6
\&{for} ${}(\|j\K\T{0};{}$ ${}\|j<\|n;{}$ ${}\|j\PP){}$\5
${}\{{}$\1\6
${}\|t\K(\|j\AND\T{1}\?\|n-\T{1}-\|j:\|n+\|j)\GG\T{1};{}$\6
${}\\{printf}(\.{"r\%c\ c\%c\ "},\39\\{encode}(\|t),\39\\{encode}(\|t));{}$\6
\4${}\}{}$\2\6
\\{printf}(\.{"|"});\6
\&{for} ${}(\|j\K\T{1};{}$ ${}\|j<\\{nn};{}$ ${}\|j\PP){}$\1\5
${}\\{printf}(\.{"\ a\%c\ b\%c"},\39\\{encode}(\|j),\39\\{encode}(\|j));{}$\2\6
\\{printf}(\.{"\\n"});\par
\U1.\fi

\M{5}\B\X5:Subroutines\X${}\E{}$\6
\&{char} \\{encode}(\|x)\1\1\6
\&{int} \|x;\2\2\6
${}\{{}$\1\6
\&{if} ${}(\|x<\T{10}){}$\1\5
\&{return} \.{'0'}${}+\|x;{}$\2\6
\&{return} \.{'a'}${}-\T{10}+\|x;{}$\6
\4${}\}{}$\2\par
\U1.\fi

\M{6}\B\X6:Output the possible queen moves\X${}\E{}$\6
\&{for} ${}(\|j\K\T{0};{}$ ${}\|j<\|n;{}$ ${}\|j\PP){}$\1\6
\&{for} ${}(\|k\K\T{0};{}$ ${}\|k<\|n;{}$ ${}\|k\PP){}$\5
${}\{{}$\1\6
${}\\{printf}(\.{"r\%c\ c\%c"},\39\\{encode}(\|j),\39\\{encode}(\|k));{}$\6
${}\|t\K\|j+\|k;{}$\6
\&{if} ${}(\|t\W(\|t<\\{nn})){}$\1\5
${}\\{printf}(\.{"\ a\%c"},\39\\{encode}(\|t));{}$\2\6
${}\|t\K\|n-\T{1}-\|j+\|k;{}$\6
\&{if} ${}(\|t\W(\|t<\\{nn})){}$\1\5
${}\\{printf}(\.{"\ b\%c"},\39\\{encode}(\|t));{}$\2\6
\\{printf}(\.{"\\n"});\6
\4${}\}{}$\2\2\par
\U1.\fi

\N{1}{7}Index.
\fi

\inx
\fin
\con
