\input cwebmac
\hypertextrue\srcloctrue

\N[1 squaregraph-rand.w]{1}{1}Intro. A simple program to make ``random''
squaregraphs, by sort of a
``crocheting'' technique. (Hacked in haste.)

\Y\B\4\D$\\{maxn}$ \5
\T{1000}\par
\Y\B\8\#\&{include} \.{<stdio.h>}\6
\8\#\&{include} \.{<stdlib.h>}\6
\8\#\&{include} \.{"gb\_flip.h"}\6
\&{int} ${}\|a[\T{2}*\\{maxn}+\T{4}],{}$ ${}\|d[\T{2}*\\{maxn}+\T{8}];{}$\6
\&{int} ${}\\{move}[\T{8}*\\{maxn}];{}$\6
\&{int} \\{count}[\\{maxn}];\6
\&{int} \\{seed};\6
\&{int} \\{steps};\7
\\{main}(\&{int} \\{argc}${},\39{}$\&{char} ${}{*}\\{argv}[\,]){}$\1\1\2\2\6
${}\{{}$\1\6
\&{register} \&{int} \|j${},{}$ \|k${},{}$ \|m${},{}$ \|t${},{}$ \|w;\7
\X2:Process the command line\X;\6
${}\|a[\T{0}]\K\T{0},\39\|a[\T{1}]\K\T{1},\39\|a[\T{2}]\K\T{0},\39\|a[\T{3}]\K%
\T{1};{}$\6
${}\|d[\T{0}]\K\|d[\T{1}]\K\|d[\T{2}]\K\|d[\T{3}]\K\T{2};{}$\6
${}\|w\K\T{4};{}$\6
\&{for} ${}(\|j\K\T{0};{}$ ${}\|j<\\{steps};{}$ ${}\|j\PP){}$\5
${}\{{}$\1\6
\X3:Set \PB{\|m} to the number of possible moves\X;\6
${}\|k\K\\{gb\_unif\_rand}(\|m);{}$\6
\X4:Make move \PB{\|k}\X;\6
\X5:Check for pairs\X;\6
\4${}\}{}$\2\6
\X6:Output the result\X;\6
\4${}\}{}$\2\par
\fi

\M[30 squaregraph-rand.w]{2}\B\X2:Process the command line\X${}\E{}$\6
\&{if} ${}(\\{argc}\I\T{3}\V\\{sscanf}(\\{argv}[\T{1}],\39\.{"\%d"},\39{\AND}%
\\{steps})\I\T{1}\V\\{sscanf}(\\{argv}[\T{2}],\39\.{"\%d"},\39{\AND}\\{seed})\I%
\T{1}){}$\5
${}\{{}$\1\6
${}\\{fprintf}(\\{stderr},\39\.{"Usage:\ \%s\ n\ seed\\n"},\39\\{argv}[%
\T{0}]);{}$\6
${}\\{exit}({-}\T{1});{}$\6
\4${}\}{}$\2\6
\&{if} ${}(\\{steps}\G\\{maxn}){}$\5
${}\{{}$\1\6
${}\\{fprintf}(\\{stderr},\39\.{"Sorry,\ n\ should\ be\ }\)\.{less\ than\ \%d!%
\\n"},\39\\{maxn});{}$\6
${}\\{exit}({-}\T{2});{}$\6
\4${}\}{}$\2\6
\\{gb\_init\_rand}(\\{seed});\par
\U1.\fi

\M[42 squaregraph-rand.w]{3}\B\X3:Set \PB{\|m} to the number of possible moves%
\X${}\E{}$\6
$\|d[\|w]\K\|d[\T{0}],\39\|d[\|w+\T{1}]\K\|d[\T{1}],\39\|a[\|w]\K\|a[\T{0}],\39%
\|a[\|w+\T{1}]\K\|a[\T{1}];{}$\6
\&{for} ${}(\|m\K\T{0};{}$ ${}\|m<\|w;{}$ ${}\|m\PP){}$\1\5
${}\\{move}[\|m]\K\|m;{}$\2\6
\&{for} ${}(\|k\K\T{0};{}$ ${}\|k<\|w;{}$ ${}\|k\PP){}$\1\6
\&{if} ${}(\|d[\|k+\T{1}]>\T{3}){}$\1\5
${}\\{move}[\|m\PP]\K\\{maxn}+\|k;{}$\2\2\6
\&{for} ${}(\|k\K\T{0};{}$ ${}\|k<\|w;{}$ ${}\|k\PP){}$\1\6
\&{if} ${}(\|d[\|k+\T{1}]>\T{3}\W\|d[\|k+\T{2}]>\T{3}){}$\1\5
${}\\{move}[\|m\PP]\K\\{maxn}+\\{maxn}+\|k{}$;\2\2\par
\U1.\fi

\M[48 squaregraph-rand.w]{4}\B\X4:Make move \PB{\|k}\X${}\E{}$\6
\&{if} ${}(\\{move}[\|k]<\\{maxn}){}$\5
${}\{{}$\1\6
${}\|w\MRL{+{\K}}\T{2},\39\|k\K\\{move}[\|k];{}$\6
\&{for} ${}(\|m\K\|w-\T{1};{}$ ${}\|m\G\|k+\T{2};{}$ ${}\|m\MM){}$\1\5
${}\|d[\|m+\T{2}]\K\|d[\|m],\39\|a[\|m+\T{2}]\K\|a[\|m];{}$\2\6
${}\|d[\|k+\T{3}]\K\|d[\|k+\T{1}]+\T{1},\39\|d[\|k+\T{2}]\K\|d[\|k+\T{1}]\K%
\T{2},\39\|d[\|k]\K\|d[\|k]+\T{1};{}$\6
${}\|a[\|k+\T{3}]\K\|a[\|k+\T{1}],\39\|a[\|k+\T{2}]\K\|j+\T{2},\39\|a[\|k+%
\T{1}]\K\|a[\|k],\39\|a[\|k]\K\|j+\T{2};{}$\6
\&{if} ${}(\|k+\T{3}\G\|w){}$\1\6
\&{for} ${}(\|t\K\T{0};{}$ ${}\|t+\|w\Z\|k+\T{3};{}$ ${}\|t\PP){}$\1\5
${}\|d[\|t]\K\|d[\|w+\|t],\39\|a[\|t]\K\|a[\|w+\|t];{}$\2\2\6
\4${}\}{}$\5
\2\&{else} \&{if} ${}(\\{move}[\|k]<\\{maxn}+\\{maxn}){}$\5
${}\{{}$\1\6
${}\|k\K\\{move}[\|k]-\\{maxn};{}$\6
${}\|d[\|k+\T{1}]\K\T{2};{}$\6
${}\|t\K\|a[\|k+\T{1}],\39\|a[\|k+\T{1}]\K\|a[\|k],\39\|a[\|k]\K\|t;{}$\6
\&{if} ${}(\|k+\T{1}\G\|w){}$\1\6
\&{for} ${}(\|t\K\T{0};{}$ ${}\|t+\|w\Z\|k+\T{1};{}$ ${}\|t\PP){}$\1\5
${}\|d[\|t]\K\|d[\|w+\|t],\39\|a[\|t]\K\|a[\|w+\|t];{}$\2\2\6
\4${}\}{}$\5
\2\&{else}\5
${}\{{}$\1\6
${}\|k\K\\{move}[\|k]-\\{maxn}-\\{maxn};{}$\6
\&{for} ${}(\|t\K\T{0};{}$ ${}\|t<\|w;{}$ ${}\|t\PP){}$\1\6
\&{if} ${}(\|a[\|t]\E\|a[\|k+\T{2}]\W\|t\I\|k+\T{2}){}$\1\5
${}\|a[\|t]\K\|a[\|k];{}$\2\2\6
${}\|a[\|k]\K\|a[\|k+\T{1}],\39\|a[\|k+\T{1}]\K\|a[\|k+\T{3}],\39\|d[\|k]\K\|d[%
\|k]+\T{1},\39\|d[\|k+\T{1}]\K\|d[\|k+\T{3}]+\T{1};{}$\6
${}\|w\MRL{-{\K}}\T{2};{}$\6
\&{for} ${}(\|t\K\|k+\T{2};{}$ ${}\|t<\|w;{}$ ${}\|t\PP){}$\1\5
${}\|a[\|t]\K\|a[\|t+\T{2}],\39\|d[\|t]\K\|d[\|t+\T{2}];{}$\2\6
\4${}\}{}$\2\par
\U1.\fi

\M[68 squaregraph-rand.w]{5}\B\X5:Check for pairs\X${}\E{}$\6
\&{for} ${}(\|k\K\T{0};{}$ ${}\|k<\|j+\T{2};{}$ ${}\|k\PP){}$\1\5
${}\\{count}[\|k]\K\T{0};{}$\2\6
\&{for} ${}(\|k\K\T{0};{}$ ${}\|k<\|w;{}$ ${}\|k\PP){}$\1\5
${}\\{count}[\|a[\|k]]\PP;{}$\2\6
\&{for} ${}(\|k\K\T{0};{}$ ${}\|k<\|j+\T{2};{}$ ${}\|k\PP){}$\1\6
\&{if} ${}(\\{count}[\|k]\I\T{0}\W\\{count}[\|k]\I\T{2}){}$\1\5
${}\\{fprintf}(\\{stderr},\39\.{"count[\%d]\ is\ \%d!\\n"},\39\|k,\39\\{count}[%
\|k]){}$;\2\2\par
\U1.\fi

\M[75 squaregraph-rand.w]{6}\B\X6:Output the result\X${}\E{}$\6
\&{for} ${}(\|k\K\T{0};{}$ ${}\|k<\|w;{}$ ${}\|k\PP){}$\5
${}\{{}$\1\6
${}\\{printf}(\.{"\ \%d"},\39\|a[\|k]);{}$\6
\&{if} ${}(\|k\MOD\T{20}\E\T{19}){}$\1\5
\\{printf}(\.{"\\n"});\2\6
\4${}\}{}$\2\6
\&{if} ${}(\|k\MOD\T{20}\I\T{0}){}$\1\5
\\{printf}(\.{"\\n"});\2\par
\U1.\fi

\N[82 squaregraph-rand.w]{1}{7}Index.
\fi

\inx
\fin
\con
